<!doctype html>
<html lang="pt">
<head>
    <meta charset="utf-8">
    <title>Tutorial: Configurando Servidor Web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- CSS do Reveal.js (Estilo dos slides) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.css">
    <!-- Tema "Simple" (Similar ao do professor) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/theme/simple.min.css">
    <!-- CSS para Destaque de Código (Tema Escuro) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github-dark.min.css">
    
    <style>
        /* Ajustes para se parecer mais com o estilo IFRN (Tema Escuro) */
        body, .reveal {
            background-color: #2b2b2b; /* Fundo cinza quase preto */
            color: #eee; /* Cor de fonte principal clara */
        }
        
        /* Alinha todo o conteúdo do slide à esquerda por padrão */
        .reveal .slides section {
            text-align: left;
        }
        
        /* --- AJUSTES DE TAMANHO DE FONTE (Correção para PC) --- */
        .reveal h1 {
            color: #77dd77; /* Verde IFRN (Claro) */
            font-weight: 600;
            text-align: left;
            font-size: 2.2em; /* Reduzido */
            line-height: 1.1;
            margin-bottom: 30px;
            text-transform: none;
        }
        
        .reveal h2 {
            color: #77dd77;
            font-weight: 600;
            text-align: left;
            font-size: 1.5em; /* Reduzido */
            margin-bottom: 20px;
        }
        
        .reveal h3 {
            color: #77dd77;
            font-weight: 600;
            text-align: left;
            font-size: 1.2em;
        }

        .reveal p, .reveal li {
            font-size: 0.9em; /* Texto base confortável */
            line-height: 1.6;
        }
        
        .reveal code {
            font-family: 'Consolas', 'Monaco', 'Andale Mono', 'Ubuntu Mono', monospace;
        }
        
        /* Ajusta o container do bloco de código */
        .reveal pre {
            width: 100%;
            background-color: #333333; /* Fundo do bloco de código */
            border: 1px solid #555;
            box-shadow: none;
            margin-top: 20px;
        }
        
        .reveal .slide-author {
            margin-top: 2rem;
            font-size: 0.8em;
            color: #ccc;
        }
        
        .reveal .slide-institution {
            font-size: 0.7em;
            color: #bbb;
        }
        
        .reveal a {
            color: #42a5f5;
        }

        /* Ajuste para o texto do terminal ser menor e caber mais */
        .reveal pre code {
            font-size: 0.7em;
            line-height: 1.2em;
            max-height: 60vh;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- Slide de Título -->
            <section>
                <h1>Configurando um Servidor Web</h1>
                <p>Nginx + MariaDB + phpMyAdmin + Acesso Remoto</p>
                <br>
                <div class="slide-institution">IFRN - Campus São Paulo do Potengi</div>
            </section>

            <!-- Slide 1: Acesso SSH (Keygen/View) -->
            <section>
                <h2>1. Acesso SSH (Máquina Local)</h2>
                <p>Gerar a chave:</p>
                <pre><code data-trim data-noescape>
PS C:\Users\...> ssh-keygen -t ed25519 -C "seu-nome"
                </code></pre>
                
                <p>Visualizar a chave pública:</p>
                <pre><code data-trim data-noescape>
PS C:\Users\...> cat .\.ssh\id_ed25519.pub
                </code></pre>
            </section>

            <!-- Slide 2: Acesso SSH (Conexão) -->
            <section>
                <h2>1. Acesso SSH (Conexão)</h2>
                <p>Conectar ao servidor remoto:</p>

                <pre><code data-trim data-noescape>
PS C:\Users\...> ssh nome-da-chave@ip-externo-da-vm
                </code></pre>
                <p>Conexão estabelecida com a instância Debian.</p>
            </section>

            <!-- Slide: Alerta de Segurança SSH -->
            <section>
                <h2>1. Acesso SSH (Primeira Conexão)</h2>
                <p>Na primeira vez, o SSH pedirá para confirmar a identidade do servidor ("Fingerprint"):</p>
                
                <pre><code data-trim data-noescape>
The authenticity of host 'ip-externo-da-vm' can't be established.
ED25519 key fingerprint is SHA256:TPRNsXMBU...
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? 
                </code></pre>

                <p>Responda: <strong>yes</strong></p>
                <p><small>Isso salvará a identidade do servidor no seu computador para futuras conexões seguras.</small></p>
            </section>
            
            <!-- Slide 3: Instalação Básica -->
            <section>
                <h2>2. Instalação dos Pacotes</h2>
                <p>Primeiro, atualize e instale o servidor web e o banco de dados:</p>
                <pre><code class="language-bash" data-trim data-noescape>
$ sudo apt update
$ sudo apt install nginx mariadb-server
                </code></pre>
            </section>

            <!-- Slide 4: Segurança MariaDB -->
            <section>
                <h2>3. MariaDB (Instalação Segura)</h2>
                <p>Executar o script de segurança:</p>
                <pre><code class="language-bash" data-trim data-noescape>
$ sudo mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED...

Enter current password for root (enter for none): 
OK, successfully used password, moving on...

Switch to unix_socket authentication [Y/n] n
Change the root password? [Y/n] n
Remove anonymous users? [Y/n] y
Disallow root login remotely? [Y/n] y
Remove test database and access to it? [Y/n] y
Reload privilege tables now? [Y/n] y
...
All done!
                </code></pre>
            </section>

            <!-- Slide 5: Configuração Remota 1 -->
            <section>
                <h2>3. MariaDB (Acesso Remoto 1)</h2>
                <p>Para acessar via Workbench, precisamos permitir conexões externas.</p>
                <p>Edite o arquivo de configuração:</p>
                <pre><code data-trim data-noescape>
$ sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf
                </code></pre>
                <p>Encontre a linha <code>bind-address</code> e altere para:</p>
                <pre><code class="ini" data-trim data-noescape>
# De: bind-address = 127.0.0.1
# Para:
bind-address = 0.0.0.0
                </code></pre>
                <p><small>(Isso permite que o banco "escute" conexões de fora)</small></p>
            </section>

            <!-- Slide 6: Configuração Remota 2 -->
            <section>
                <h2>3. MariaDB (Acesso Remoto 2)</h2>
                <p>Entre no banco e crie um usuário remoto:</p>
                <pre><code data-trim data-noescape>
$ sudo mysql -u root

MariaDB [(none)]> CREATE USER 'aluno'@'%' IDENTIFIED BY 'ifrn123';
MariaDB [(none)]> GRANT ALL PRIVILEGES ON *.* TO 'aluno'@'%' WITH GRANT OPTION;
MariaDB [(none)]> FLUSH PRIVILEGES;
MariaDB [(none)]> exit;
                </code></pre>
                <p>Reinicie o serviço para aplicar:</p>
                <pre><code data-trim data-noescape>
$ sudo systemctl restart mariadb
                </code></pre>
            </section>
            
            <!-- Slide 7: Instalação PHP -->
            <section>
                <h2>4. Instalação (PHP & phpMyAdmin)</h2>
                <p>Instalar os pacotes necessários:</p>
                <pre><code data-trim data-noescape>
$ sudo apt install phpmyadmin php-fpm php-mysql
Reading package lists... Done
Building dependency tree... Done
...
0 upgraded, 97 newly installed, 0 to remove and 5 not upgraded.
Need to get 33.8 MB of archives.
After this operation, 151 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
                </code></pre>
                <p><small>Nota: Se perguntar servidor web, deixe em branco (TAB -> OK). Se perguntar dbconfig, sim.</small></p>
            </section>

            <!-- Slide 8: O Problema (Conflito) -->
            <section>
                <h2>5. Resolução de Conflitos</h2>
                <p><strong>O Problema:</strong> O <code>apache2</code> tenta usar a porta 80.</p>
                <pre><code data-trim data-noescape>
$ sudo systemctl status apache2

● apache2.service - The Apache HTTP Server
     Loaded: loaded (/lib/systemd/system/apache2.service; enabled; ...)
     Active: failed (Result: exit-code) ...
...
Nov 07 19:42:25 ... apachectl[381]: (98)Address already in use: AH00072: make_sock: could not bind to address ...
                </code></pre>
            </section>
            
            <!-- Slide 9: A Solução (Desabilitar Apache) -->
            <section>
                <h2>5. Resolução de Conflitos</h2>
                <p><strong>A Solução:</strong> Parar e desabilitar o Apache2.</p>
                <pre><code data-trim data-noescape>
$ sudo systemctl disable apache2
$ sudo systemctl stop apache2
                </code></pre>
                <p><strong>Verificar Nginx</strong>:</p>
                <pre><code data-trim data-noescape>
$ sudo systemctl status nginx
● nginx.service - A high performance web server and a reverse proxy server
     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; ...)
     Active: active (running) since Fri 2025-11-07 19:42:23 UTC; 45min ago
                </code></pre>
            </section>

            <!-- Slide 10: A Correção (Edição) -->
            <section>
                <h2>6. Configuração do Nginx</h2>
                <p>O comando correto para editar o arquivo:</p>
                <pre><code data-trim data-noescape>
$ sudo nano /etc/nginx/sites-available/default
                </code></pre>
                <p>(Dentro deste arquivo, você adiciona a configuração para o PHP e a <code>location /phpmyadmin</code>)</p>
            </section>
            
            <!-- Slide 11: Link Simbólico (IMPORTANTE) -->
            <section>
                <h2>6. Configuração do Nginx (Link)</h2>
                <p>Para facilitar o acesso ao phpMyAdmin, crie um link simbólico:</p>
                <pre><code data-trim data-noescape>
$ sudo ln -s /usr/share/phpmyadmin /var/www/html/phpmyadmin
                </code></pre>
                <p><small>Isso cria um "atalho" na pasta do site que aponta para a instalação do phpMyAdmin.</small></p>
            </section>

            <!-- Slide 12: Passos Finais -->
            <section>
                <h2>6. Configuração do Nginx (Fim)</h2>
                <p>Após salvar no <code>nano</code> e criar o link, reinicie o Nginx:</p>
                
                <pre><code data-trim data-noescape>
$ sudo systemctl restart nginx
$ sudo systemctl status nginx
● nginx.service - A high performance web server and a reverse proxy server
     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; preset: enabled)
     Active: active (running) since Fri 2025-11-07 20:44:31 UTC; 10s ago
                </code></pre>
                <p><strong>Sucesso!</strong> Servidor pronto.</p>
            </section>

            <!-- Slide Final -->
            <section>
                <h2>Fim!</h2>
                <p>Tutorial de configuração do servidor concluído.</p>
                <p>Agora você pode testar o acesso pelo navegador e pelo MySQL Workbench.</p>
            </section>

        </div>
    </div>

    <!-- JS do Reveal.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/highlight.min.js"></script>
    <script>
        // Inicialização
        Reveal.initialize({
            hash: true,
            plugins: [ RevealHighlight ],
            slideNumber: true, // <-- Esta linha controla a numeração da página
        });
    </script>
</body>
</html>
